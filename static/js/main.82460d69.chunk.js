(this["webpackJsonpalmex-contractor"]=this["webpackJsonpalmex-contractor"]||[]).push([[0],{131:function(e,t,n){e.exports={wrapper:"signin_wrapper__31duv",content:"signin_content__2p7Gu",container:"signin_container__jIzED",button:"signin_button__bG6AB",form:"signin_form__3OtOE"}},175:function(e,t,n){e.exports={wrapper:"logo_wrapper__3vcav",text:"logo_text__1Cx8t"}},252:function(e,t,n){e.exports={loader:"loader_loader__2sbTU"}},254:function(e,t,n){e.exports={wrapper:"start-app-fail_wrapper__39QCk"}},260:function(e,t){},267:function(e,t,n){e.exports=n(510)},272:function(e,t,n){},281:function(e,t){},510:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setThrift",(function(){return de})),n.d(a,"MrkClientServiceClient",(function(){return ge}));var r=n(0),c=n.n(r),o=n(4),l=n.n(o),i=(n(272),n(23)),s=n(34),u=n(519),p=n(513),m=n(131),g=n(118),d=n(119),f=n(128),h=n(120),v=n(130),b=n(94),E=n(19),w=n.n(E),_=n(79),j=n(29),y=n(2),I=n.n(y),k=n(518),x=n(512),O=n(515),S=n(49),N=n.n(S),C="/almex-contractor",T=n(20),R=function(e){function t(){var e,n;Object(g.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).setlang=function(e){var t,a;return w.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.props.locale!==e.value){r.next=3;break}return r.abrupt("return",null);case 3:return r.prev=3,r.next=6,w.a.awrap(fetch("".concat(C,"/translates/").concat(e.value,".json")));case 6:return t=r.sent,r.next=9,w.a.awrap(t.json());case 9:a=r.sent,n.props.loadTranslations(Object(_.a)({},e.value,a)),n.props.setLocale(e.value),localStorage.setItem("lang",e.value),N.a.locale(e.value),r.next=19;break;case 16:r.prev=16,r.t0=r.catch(3),k.a.error({key:"locale_not_found",message:T.I18n.t("common.error"),description:T.I18n.t("SignIn.locale_not_found")});case 19:case"end":return r.stop()}}),null,null,[[3,16]])},n}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.locale,a=t.language;return c.a.createElement(x.a,null,c.a.createElement(O.a.Text,{onClick:function(){return e.setlang(a)},className:I()(b.item,a.value===n?b.active:null)},a.value))}}]),t}(r.Component),A=Object(i.connect)((function(e){return{locale:e.i18n.locale}}),(function(e){return Object(j.bindActionCreators)({loadTranslations:T.loadTranslations,setLocale:T.setLocale},e)}))(R),F=function(e){function t(){return Object(g.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.list,t=void 0===e?[]:e;return c.a.createElement(p.a,{className:b.list,type:"flex",justify:"center",align:"middle",gutter:16},t.map((function(e){return c.a.createElement(A,{key:e.value,language:e})})))}}]),t}(r.PureComponent),G=Object(i.connect)((function(e){return{list:e.i18n.list}}))(F),L="".concat("/almex-contractor","/assets/img/Logo.svg"),M=n(175),P=function(){return c.a.createElement("div",{className:M.wrapper},c.a.createElement("img",{src:L,alt:"logo"}),c.a.createElement("span",{className:M.text},"contractor"))},U=n(516),z=n(517),q=n(31),W=n(181),B=function(e){return function(t,n,a){var r,c,o,l;return w.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t({type:"SIGN_IN_REQUEST"}),i.prev=1,r=n(),c=r.i18n.locale,o=r.settings.APP_VERSION,i.next=5,w.a.awrap(a.MrkClientServiceClient.authMrkClient(e.login,e.password,null,c,o));case 5:l=i.sent,localStorage.setItem("token",l.id),t({type:"SIGN_IN_SUCCESS",payload:l}),i.next=15;break;case 10:i.prev=10,i.t0=i.catch(1),i.t0.preconditionExceptionKey&&k.a.error({key:"login",message:i.t0.message}),t({type:"SIGN_IN_FAILURE"}),i.t0;case 15:case"end":return i.stop()}}),null,null,[[1,10]])}},D=n(134),J=Object(i.connect)((function(e){return{token:e.auth.token,isFetching:e.auth.isFetching}}),(function(e){return Object(j.bindActionCreators)({login:B},e)}))((function(e){var t=e.login,n=e.token,a=e.isFetching;return null!==n?c.a.createElement(s.a,{to:{pathname:"/"}}):c.a.createElement(q.b,{initialValues:{login:"",password:""},validationSchema:D.object().shape({login:D.string().required(T.I18n.t("form.required")),password:D.string().required(T.I18n.t("form.required"))}),onSubmit:function(e){t(e)}},(function(){return c.a.createElement(U.a,{style:{width:260}},c.a.createElement(U.a.Item,{name:"login"},c.a.createElement(z.a,{name:"login",placeholder:T.I18n.t("SignIn.login"),size:"large"})),c.a.createElement(U.a.Item,{name:"password",extra:null},c.a.createElement(z.a.Password,{name:"password",placeholder:T.I18n.t("SignIn.password"),size:"large"})),c.a.createElement(p.a,{gutter:[24,24]},c.a.createElement(x.a,null,c.a.createElement(W.a,{type:"primary",block:!0,size:"large",htmlType:"submit",loading:a},T.I18n.t("SignIn.sign_in"))),c.a.createElement(x.a,null,c.a.createElement(W.a,{block:!0,size:"large",htmlType:"button"},T.I18n.t("SignIn.sign_up")))))}))})),Q=u.a.Content,H=function(){return c.a.createElement(u.a,{className:m.container},c.a.createElement(Q,{className:m.wrapper},c.a.createElement(p.a,{className:m.content},c.a.createElement(P,null),c.a.createElement(G,null),c.a.createElement(J,null))))},V=function(){return c.a.createElement("div",null,"MrkDocuments")},K=n(252),X=n(514),$=function(){return c.a.createElement("div",{className:K.loader},c.a.createElement(X.a,null))},Y=n(262),Z=Object(i.connect)((function(e){return{token:e.auth.token}}))((function(e){var t=e.component,n=e.token,a=Object(Y.a)(e,["component","token"]);return c.a.createElement(s.b,Object.assign({},a,{render:function(e){return null!==n?c.a.createElement(t,e):c.a.createElement(s.a,{to:{pathname:"/signIn"}})}}))})),ee=n(520),te=n(254),ne=function(){return c.a.createElement(p.a,{type:"flex",justify:"center",align:"middle",className:te.wrapper},c.a.createElement(ee.a,{message:"Error: failed to connect, server not responding",description:c.a.createElement(p.a,{type:"flex",justify:"center"},c.a.createElement(W.a,{type:"danger",onClick:function(){return window.location.reload()}},"Try again")),type:"error"}))},ae=Object(i.connect)((function(e){return{loading:e.asyncInitialState.loading,error:e.asyncInitialState.error}}))((function(e){var t=e.loading;return null!==e.error?c.a.createElement(ne,null):c.a.createElement(c.a.Fragment,null,t?c.a.createElement($,null):c.a.createElement(s.d,null,c.a.createElement(s.b,{exact:!0,path:"/signIn",component:H}),c.a.createElement(Z,{exact:!0,path:"/",component:V}),c.a.createElement(s.a,{to:"/"})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var re=n(93),ce=n(235),oe=n(255),le=n(97),ie=n(127),se=n(37),ue=Object(se.a)({token:localStorage.getItem("token")||null},new MrkClientSession,{isFetching:!1}),pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_IN_REQUEST":return Object(se.a)({},e,{isFetching:!0});case"SIGN_IN_SUCCESS":return Object(se.a)({},e,{isFetching:!1,token:t.payload.id},t.payload);case"SIGN_IN_FAILURE":return Object(se.a)({},e,{isFetching:!1});default:return e}},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type,e},ge=null,de=function(e){var t;return w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:t=e.THRIFT,ge=new window.MrkClientServiceClient(new window.Thrift.Protocol(new window.Thrift.Transport("".concat(t.URL,"/").concat(t.API,"/thrift/mrk-client-json"))));case 2:case"end":return n.stop()}}))},fe=n(258),he=function(e){return new Promise((function(t,n){var a,r,c,o,l,i,s,u,p,m;return w.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:return a=e(),r=Object(se.a)({},a.auth),g.prev=2,g.next=5,w.a.awrap(fetch("".concat(C,"/web-config.json")));case 5:return c=g.sent,g.next=8,w.a.awrap(c.json());case 8:return o=g.sent,g.next=11,w.a.awrap(de(o));case 11:if(null===r.token){g.next=24;break}return g.prev=12,g.next=15,w.a.awrap(ge.refreshMrkClientSession(r.token));case 15:(l=g.sent)&&(r=Object(se.a)({},l,{token:l.id})),g.next=24;break;case 19:g.prev=19,g.t0=g.catch(12),g.t0,r=Object(se.a)({},r,{token:null}),localStorage.removeItem("token");case 24:return i=localStorage.getItem("lang")||o.LANG,g.next=27,w.a.awrap(fetch("".concat(C,"/translates/").concat(i,".json")));case 27:return s=g.sent,g.t1=_.a,g.t2={},g.t3=i,g.next=33,w.a.awrap(s.json());case 33:return g.t4=g.sent,u=(0,g.t1)(g.t2,g.t3,g.t4),N.a.locale(i),g.next=38,w.a.awrap(ge.getAllLanguages());case 38:return p=g.sent,g.next=41,w.a.awrap(ge.getInfo());case 41:m=g.sent,t(Object(se.a)({},a,{auth:r,settings:Object(se.a)({},m,{},o),i18n:{locale:i,translations:u,list:Object(fe.reduce)(p,(function(e,t,n){return e.push({name:t,value:n}),e}),[])}})),g.next=49;break;case 45:g.prev=45,g.t5=g.catch(2),g.t5,n(g.t5);case 49:case"end":return g.stop()}}),null,null,[[2,45],[12,19]])}))},ve=n(259),be=n(28),Ee=Object(be.a)(),we=function(){var e,t=[oe.a.withExtraArgument(a),Object(ce.a)(Ee),le.middleware(he)],n=[Object(ve.composeWithDevTools)(j.applyMiddleware.apply(void 0,t))];return Object(j.createStore)((e=Ee,le.outerReducer(Object(j.combineReducers)({router:Object(re.b)(e),asyncInitialState:le.innerReducer,i18n:T.i18nReducer,modals:ie.reducer,auth:pe,settings:me}))),j.compose.apply(void 0,n))}();Object(T.syncTranslationWithStore)(we);var _e,je=we,ye=n(260),Ie=n(92),ke=Object(ie.ModalRoot)(je);_e=ae,l.a.render(c.a.createElement(i.Provider,{store:je},c.a.createElement(re.a,{history:Ee},c.a.createElement(Ie.a,{basename:C},c.a.createElement(_e,null)),c.a.createElement(ke,{modalComponents:ye}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},94:function(e,t,n){e.exports={list:"languages_list__1NJHh",item:"languages_item__g1mgX",active:"languages_active__3h82-"}}},[[267,1,2]]]);
//# sourceMappingURL=main.82460d69.chunk.js.map